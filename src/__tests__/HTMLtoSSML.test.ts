import { HTMLtoSSML } from '../index';

describe('striptags', () => {
    test('headers', () => {
        const converter = new HTMLtoSSML();
        const html = "<h1>Test</h1>";
        expect(converter.deleteHTML(html)).toBe(html);
    });
    test('change-allowedTags', () => {
        const converter = new HTMLtoSSML();
        converter.config.allowedTags = ['a']
        let html = "<a>Test</a>";
        expect(converter.deleteHTML(html)).toBe(html);
        html = "<h1>Test</h1>";
        expect(converter.deleteHTML(html)).toBe("Test");
    });
});

describe('realTest', () => {
    test('headland', () => {
        const converter = new HTMLtoSSML();
        const html = '<div><img src="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Cover-1608155028318.jpg" alt /><p><a href="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Cover-1608155028318.jpg"></a></p></div><p><a href="https://www.headlandgame.com/">Headland</a> is a new game for iOS and Android by the award winning game studio <a href="https://northplay.co/">Northplay</a>. The game revolves around a young boy exploring a world of his own imagination; fighting enemies and hunting down the missing shards of his robot friend’s “imagination core.” I played through Headland over the last few days and found it to be a well-made and overall quite enjoyable experience.</p><p>I really like that Headland plays in portrait orientation. Most games like it run in landscape, which is fine, but it’s nice to have a change. On my iPhone Mini I can actually play Headland entirely one-handed, which makes the game feel more light and casual even though its gameplay is engaging. Playing two-handed on my iPad Pro was still fun though since I could support the device with a single hand and play with the other.</p><div><span></span></div><p>The key to this is the game’s excellent controls, which are intuitive and only require a single finger at any given time. To move your character, you place your finger anywhere on the screen and then rotate it. This is essentially a joystick movement control, but it works so much better because the joystick will appear underneath your finger wherever you place it. My struggle with most touch-joystick games is that I end up placing my finger off-center from the stationary joystick and then I move in an unwanted direction. This never happens in Headland.</p><p></p><p>The character that you control is a young boy named Nor who is imagining the titular land in his head. Nor has unsurprisingly also imagined himself some weaponry, beginning with a wooden sword that he pulls out of a log. This introduces a second mechanic: attacking. To attack, you simply tap the screen. Nor will maneuver his weapon in a three-phase assault, swiping it back, then forth, then stabbing it forward (the stab will knock enemies backward a short distance). You need to tap three times to complete this full sequence.</p><div><img src="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156602465.png" alt /><p><a href="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156602465.png"></a></p></div><p>The final control in the game is a shield, which you can activate by tapping and holding (you need to play for a little while before this ability is unlocked). The shield is quite strong, and feels a bit overpowered early on. As you get further into the game though, it starts to feel like a more balanced tool while combatting growing enemy forces.</p><p>It takes a while to charge the shield up (charging occurs as you fight enemies), but once you unleash it you knock back all surrounding enemies and deal damage to anything your shield touches for a few seconds. It’s important to note that some enemies are immovable, and thus are not thrown out of the shield area. These enemies can still damage you while inside of your shield, but they’ll receive damage over time for the its duration. If you step back so that they’re out of your shield then you will block all of their projectiles, but will stop damaging them.</p><p>Personally I try my best to not use the shield because I have more fun <a href="https://en.wikipedia.org/wiki/Glossary_of_video_game_terms#kiting">kiting</a> enemies by moving and attacking. If you get into a sticky situation though then the shield is a nice get-out-of-jail-free card.</p><div><img src="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156635085.png" alt /><p><a href="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156635085.png"></a></p></div><p>Headland kicks off with Nor diving through a portal in his bedroom into his own imagination. It’s here that he meets various robot friends, in particular a spunky robot named Spud who is living his best life. At least, he is until a horrible worm monster appears and steals his imagination core; breaking it into five pieces and scattering them throughout Headland.</p><p><a href="https://en.wikipedia.org/wiki/MacGuffin">MacGuffins</a> in place, our adventure can begin in earnest. I’ll be honest, this initial portion of the game felt a bit childish for my tastes. That might be fitting given that Headland literally takes place inside a child’s imagination, but it didn’t leave me particularly intrigued about playing through the story further. Thankfully, this feeling evaporated quickly once I was freed from introductory cutscenes and released into the Headland world.</p><p>The game feels somewhat open in that you can roam around at will, but there are specific tasks that you need to accomplish which are pretty guided. You begin in a location called the Robot Raft, which is a flying fortress piloted and inhabited by robots. In particular you’ll find a blacksmith robot here who will forge new weapons for you or upgrade your existing weapons.</p><p>To afford upgrades you need to collect resources. These are scattered throughout the map in the form of objects like logs, stumps, and rocks. When you attack these objects you’ll gather wood, stone, or gold from them which you can then use to pay the blacksmith. As you progress through the game you’ll unlock new weapons over time, and you’ll need to choose when to buy a new weapon rather than upgrading one of your existing ones.</p><p>You can only use one weapon at a time in Headland, and each one has different attributes. My favorite is the Cerulian Bolt, which buffs movement speed so that you can zoom around in battles. If you find yourself dying often then you might like the Golden Pick instead, which provides you with an extra heart (giving you six instead of the standard five) alongside improving your resource gathering. There are a total of seven weapons available which buff various abilities, so I’m sure most people can find one that best fits their play style. I strongly recommend taking the Cerulean Bolt into the final battle though, and overall I think it’s the best weapon in the game.</p><p>On the Robot Raft you’ll find three gates with robot guardians. Each gate requires a different color of key, and you’ll collect these keys while playing through the game. Each time you go through one of the gates you’ll face a challenge in the form of several waves of enemies. Winning these challenges is how you unlock new weapons, but it can also be a good way to gather extra resources for upgrades if you have extra keys saved up.</p><div><img src="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156922877.png" alt /><p><a href="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156922877.png"></a></p></div><p>Finally, at the top of the Robot Raft is the “world map.” This isn’t really a map, it’s actually a slingshot that will throw you to an island from which you can access the game’s various locations. You enter a location by swiping it with your weapon, and each one consists of a challenge that you’ll need to beat before moving forward to the next one. Some of the challenges are a bit puzzle-like in nature, but for the most part this is a game about fighting waves of enemies. You might need to wander for a minute or so to find the pathway to the next area, but it’s never particularly difficult and you’ll soon be back in the thick of battle.</p><p>If you like games with more exploration, Headland has a bit of that too. Each location has between one and three “secrets,” which are hidden areas that give you prizes, but aren’t required to progress in the game. The secrets aren’t particularly difficult to find, but you will need to employ some extra curiosity like wandering into houses for no reason or running into walls to make sure they’re actually walls. I like that Headland tells you the number of secrets and whether or not you’ve found them when you’re looking at a location from the world map. This gives you a proper sense of whether you’ve fully explored the game, without making you waste time checking for hidden places after you’ve already found them all.</p><p>Headland does an impressive job walking the line between challenging and forgiving. It’s not a difficult game by any means, but that’s mostly because of the way it implements its death mechanic. When you die in Headland you lose a small amount of resources and are sent back to your last checkpoint. Checkpoints are scattered all throughout the game, so as long as you’re hitting them with your weapon when you walk by, you’ll rarely be sent back a significant amount. From there you can return to wherever you lost your life and generally pick up the fight right where you left off — including that the enemies you already killed will still be dead. You can even find the gravestone which marks where you last died and attack it to reveal some extra enemies. Killing them will give you back most of the resources that you lost upon your death.</p><p>This mechanic certainly makes Headland “easy” from a gamer’s point of view, but it results in the game feeling a lot more relaxing to play. I was never particularly worried about dying, so I could be a bit more nonchalant about running headlong into fights I was not prepared for. I think overall the low stakes of Headland allow players to choose their own level of difficulty based on how competitive they feel like being. Personally I was pretty determined to die as few times as possible, but if you’re a more casual gamer then you can enjoy Headland and not particularly mind if you don’t fare well in the more difficult battles.</p><div><img src="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156649573.png" alt /><p><a href="https://d8fa96d6061491bec818-41a52a109fa0fefb17700938627149a6.ssl.cf1.rackcdn.com/Image-1608156649573.png"></a></p></div><p>Ultimately I found Headland to be an utterly charming game. From the character and map designs to the fact that you can actually find the game’s developer inside the game, working on developing the game — Headland exudes charm. The story could have used some work, but the fun gameplay, excellent controls, and beautiful art design were more than enough to support a simplistic storyline.</p><p>Headland is a <a href="https://apps.apple.com/us/app/headland/id1339714199">free download on the App Store</a>, with an in-app purchase to unlock the full game. The free version allows you to play through the “first 45 minutes” of the game, which is actually just an estimate of how long it will take you to complete the first two locations. I found that estimate to be pretty accurate, but you can definitely enjoy even more than 45 minutes of play on the free version. I spent some extra time fighting in one of the gates on the Robot Raft to collect resources and upgrade weapons before I unlocked the in-app purchase and continued. The free intro is more than enough time to know if you’ll enjoy this game.</p><p>Headland’s in-app purchase is a one-time charge of $5.99. There are no microtransactions in this game so I think that’s a fair price for what Northplay claims is an extra five-and-a-half hours of gameplay. I personally played for around 7 hours total so far, and will likely play some more before I move on to something new. If you’re determined to unlock everything in the game (there’s a whole aspect of decorating the Robot Raft which requires significant resources but is just for fun) then you could easily play for many more hours by fighting the same challenges to mine resources, beat high scores, and buy decorations.</p>';
        const ssml = 'Headland is a new game for iOS and Android by the award winning game studio Northplay. The game revolves around a young boy exploring a world of his own imagination; fighting enemies and hunting down the missing shards of his robot friend’s “imagination core.” I played through Headland over the last few days and found it to be a well-made and overall quite enjoyable experience.I really like that Headland plays in portrait orientation. Most games like it run in landscape, which is fine, but it’s nice to have a change. On my iPhone Mini I can actually play Headland entirely one-handed, which makes the game feel more light and casual even though its gameplay is engaging. Playing two-handed on my iPad Pro was still fun though since I could support the device with a single hand and play with the other.The key to this is the game’s excellent controls, which are intuitive and only require a single finger at any given time. To move your character, you place your finger anywhere on the screen and then rotate it. This is essentially a joystick movement control, but it works so much better because the joystick will appear underneath your finger wherever you place it. My struggle with most touch-joystick games is that I end up placing my finger off-center from the stationary joystick and then I move in an unwanted direction. This never happens in Headland.The character that you control is a young boy named Nor who is imagining the titular land in his head. Nor has unsurprisingly also imagined himself some weaponry, beginning with a wooden sword that he pulls out of a log. This introduces a second mechanic: attacking. To attack, you simply tap the screen. Nor will maneuver his weapon in a three-phase assault, swiping it back, then forth, then stabbing it forward (the stab will knock enemies backward a short distance). You need to tap three times to complete this full sequence.The final control in the game is a shield, which you can activate by tapping and holding (you need to play for a little while before this ability is unlocked). The shield is quite strong, and feels a bit overpowered early on. As you get further into the game though, it starts to feel like a more balanced tool while combatting growing enemy forces.It takes a while to charge the shield up (charging occurs as you fight enemies), but once you unleash it you knock back all surrounding enemies and deal damage to anything your shield touches for a few seconds. It’s important to note that some enemies are immovable, and thus are not thrown out of the shield area. These enemies can still damage you while inside of your shield, but they’ll receive damage over time for the its duration. If you step back so that they’re out of your shield then you will block all of their projectiles, but will stop damaging them.Personally I try my best to not use the shield because I have more fun kiting enemies by moving and attacking. If you get into a sticky situation though then the shield is a nice get-out-of-jail-free card.Headland kicks off with Nor diving through a portal in his bedroom into his own imagination. It’s here that he meets various robot friends, in particular a spunky robot named Spud who is living his best life. At least, he is until a horrible worm monster appears and steals his imagination core; breaking it into five pieces and scattering them throughout Headland.MacGuffins in place, our adventure can begin in earnest. I’ll be honest, this initial portion of the game felt a bit childish for my tastes. That might be fitting given that Headland literally takes place inside a child’s imagination, but it didn’t leave me particularly intrigued about playing through the story further. Thankfully, this feeling evaporated quickly once I was freed from introductory cutscenes and released into the Headland world.The game feels somewhat open in that you can roam around at will, but there are specific tasks that you need to accomplish which are pretty guided. You begin in a location called the Robot Raft, which is a flying fortress piloted and inhabited by robots. In particular you’ll find a blacksmith robot here who will forge new weapons for you or upgrade your existing weapons.To afford upgrades you need to collect resources. These are scattered throughout the map in the form of objects like logs, stumps, and rocks. When you attack these objects you’ll gather wood, stone, or gold from them which you can then use to pay the blacksmith. As you progress through the game you’ll unlock new weapons over time, and you’ll need to choose when to buy a new weapon rather than upgrading one of your existing ones.You can only use one weapon at a time in Headland, and each one has different attributes. My favorite is the Cerulian Bolt, which buffs movement speed so that you can zoom around in battles. If you find yourself dying often then you might like the Golden Pick instead, which provides you with an extra heart (giving you six instead of the standard five) alongside improving your resource gathering. There are a total of seven weapons available which buff various abilities, so I’m sure most people can find one that best fits their play style. I strongly recommend taking the Cerulean Bolt into the final battle though, and overall I think it’s the best weapon in the game.On the Robot Raft you’ll find three gates with robot guardians. Each gate requires a different color of key, and you’ll collect these keys while playing through the game. Each time you go through one of the gates you’ll face a challenge in the form of several waves of enemies. Winning these challenges is how you unlock new weapons, but it can also be a good way to gather extra resources for upgrades if you have extra keys saved up.Finally, at the top of the Robot Raft is the “world map.” This isn’t really a map, it’s actually a slingshot that will throw you to an island from which you can access the game’s various locations. You enter a location by swiping it with your weapon, and each one consists of a challenge that you’ll need to beat before moving forward to the next one. Some of the challenges are a bit puzzle-like in nature, but for the most part this is a game about fighting waves of enemies. You might need to wander for a minute or so to find the pathway to the next area, but it’s never particularly difficult and you’ll soon be back in the thick of battle.If you like games with more exploration, Headland has a bit of that too. Each location has between one and three “secrets,” which are hidden areas that give you prizes, but aren’t required to progress in the game. The secrets aren’t particularly difficult to find, but you will need to employ some extra curiosity like wandering into houses for no reason or running into walls to make sure they’re actually walls. I like that Headland tells you the number of secrets and whether or not you’ve found them when you’re looking at a location from the world map. This gives you a proper sense of whether you’ve fully explored the game, without making you waste time checking for hidden places after you’ve already found them all.Headland does an impressive job walking the line between challenging and forgiving. It’s not a difficult game by any means, but that’s mostly because of the way it implements its death mechanic. When you die in Headland you lose a small amount of resources and are sent back to your last checkpoint. Checkpoints are scattered all throughout the game, so as long as you’re hitting them with your weapon when you walk by, you’ll rarely be sent back a significant amount. From there you can return to wherever you lost your life and generally pick up the fight right where you left off — including that the enemies you already killed will still be dead. You can even find the gravestone which marks where you last died and attack it to reveal some extra enemies. Killing them will give you back most of the resources that you lost upon your death.This mechanic certainly makes Headland “easy” from a gamer’s point of view, but it results in the game feeling a lot more relaxing to play. I was never particularly worried about dying, so I could be a bit more nonchalant about running headlong into fights I was not prepared for. I think overall the low stakes of Headland allow players to choose their own level of difficulty based on how competitive they feel like being. Personally I was pretty determined to die as few times as possible, but if you’re a more casual gamer then you can enjoy Headland and not particularly mind if you don’t fare well in the more difficult battles.Ultimately I found Headland to be an utterly charming game. From the character and map designs to the fact that you can actually find the game’s developer inside the game, working on developing the game — Headland exudes charm. The story could have used some work, but the fun gameplay, excellent controls, and beautiful art design were more than enough to support a simplistic storyline.Headland is a free download on the App Store, with an in-app purchase to unlock the full game. The free version allows you to play through the “first 45 minutes” of the game, which is actually just an estimate of how long it will take you to complete the first two locations. I found that estimate to be pretty accurate, but you can definitely enjoy even more than 45 minutes of play on the free version. I spent some extra time fighting in one of the gates on the Robot Raft to collect resources and upgrade weapons before I unlocked the in-app purchase and continued. The free intro is more than enough time to know if you’ll enjoy this game.Headland’s in-app purchase is a one-time charge of $5.99. There are no microtransactions in this game so I think that’s a fair price for what Northplay claims is an extra five-and-a-half hours of gameplay. I personally played for around 7 hours total so far, and will likely play some more before I move on to something new. If you’re determined to unlock everything in the game (there’s a whole aspect of decorating the Robot Raft which requires significant resources but is just for fun) then you could easily play for many more hours by fighting the same challenges to mine resources, beat high scores, and buy decorations.';
        expect(converter.deleteHTML(html)).toBe(ssml);    
    });
});

describe("replace tags", () => {
    test("h1", () => {
        const converter = new HTMLtoSSML();
        const html = "<h1>Test</h1>";
        expect(converter.convertHTMLTagsToSSMLTags(html)).toBe("<emphasis>Test</emphasis>");
    });
    test("h2", () => {
        const converter = new HTMLtoSSML();
        const html = "<h2>Test</h2>";
        expect(converter.convertHTMLTagsToSSMLTags(html)).toBe("<emphasis>Test</emphasis>");
    });
    test("h3", () => {
        const converter = new HTMLtoSSML();
        const html = "<h3>Test</h3>";
        expect(converter.convertHTMLTagsToSSMLTags(html)).toBe("<emphasis>Test</emphasis>");
    });
    test("br", () => {
        const converter = new HTMLtoSSML();
        const html = "Test<br>New line";
        expect(converter.convertHTMLTagsToSSMLTags(html)).toBe("Test<break>New line");
    })
});